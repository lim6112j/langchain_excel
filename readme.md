# readme
# 엑셀 정책 기반 정산 계산기

이 애플리케이션은 엑셀 파일의 정책 시트를 기준으로 매출 시트의 여러 업체 정산금을 계산하고, 이해가 안 되는 항목에 대해 질문할 수 있는 Gradio LangGraph 앱입니다.

## 기능

- 엑셀 파일 업로드 (정책 시트와 매출 시트 포함)
- 정책 기반 자동 정산 계산
- 불명확한 정책 항목 식별 및 질문 생성
- 사용자 답변을 통한 정책 명확화
- 최종 정산 결과 요약

## 설치 방법

1. 필요한 패키지 설치:

```bash
pip install -r requirements.txt
```

2. OpenAI API 키 설정:

```bash
export OPENAI_API_KEY=your_api_key_here
```

## 사용 방법

1. 애플리케이션 실행:

```bash
python app.py
```

2. 웹 브라우저에서 표시된 URL로 접속

3. 정책 시트와 매출 시트가 포함된 엑셀 파일 업로드

4. 불명확한 항목에 대한 질문에 답변

5. 최종 정산 결과 확인

## 샘플 데이터 생성

테스트용 샘플 데이터를 생성하려면:

```bash
python sample_data.py
```

이 명령어는 `sample_data.xlsx` 파일을 생성합니다.

## 엑셀 파일 형식

### 정책 시트
- 필수 열: '업체명', '수수료율'
- 기타 정책 관련 열 (예: 정산주기, 프로모션, 특별할인 등)

### 매출 시트
- 필수 열: '업체명', '매출액'
- 기타 매출 관련 열 (예: 날짜, 상품명 등)

## 주의사항

- 불명확한 정책 항목은 텍스트에 '확인필요'가 포함된 항목으로 식별됩니다.
- 정산 계산 로직은 기본적인 수수료 계산과 프로모션 할인을 포함합니다.
# langchain_excel
